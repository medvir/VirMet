{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to VirMet","text":"<p>VirMet is a software suite designed to help users running viral metagenomics  (mNGS) experiments: unspecific massively parallel NGS sequencing with the aim  of discovering and characterizing the virus fraction of biological samples.</p> <p>To see and download the code, visit our GitHub. Information on how to install VirMet can be found in the Installation section.</p> <p>VirMet is called with a command-subcommand syntax. All the possible subcommands are:</p> <ul> <li><code>fetch</code>: download genomes</li> <li><code>update</code>: update viral database</li> <li><code>index</code>: index genomes</li> <li><code>wolfpack</code>: analyze a Miseq run or file</li> <li><code>covplot</code>: plot coverage for a specific organism</li> </ul> <p>Some help can be obtained with <code>virmet &lt;subcommand&gt; -h</code> or simply <code>virmet -h</code>:</p> <pre><code>virmet -h\nusage: virmet &lt;command&gt; [options]\n\npositional arguments:\n  {fetch,update,index,wolfpack,covplot}\n                        available sub-commands\n    fetch               download genomes\n    update              update viral database\n    index               index genomes\n    wolfpack            analyze a Miseq run\n    covplot             create coverage plot\n\noptions:\n  -h, --help            show this help message and exit\n  -v, --version         show program's version number and exit\n\nRun `virmet subcommand -h` for more help\n</code></pre> <p>Enjoy using VirMet!</p> <p></p>"},{"location":"Covplot/","title":"Inspecting the results: <code>covplot</code>","text":""},{"location":"Covplot/#covplot","title":"Covplot","text":"<p>After a run of <code>Wolfpack</code>, the <code>orgs_list.tsv</code> files show how many reads per sample are assigned to a given viral organism, and  (unless <code>--nocovplot</code> is requested), the tool also creates coverage plots for a few viral organisms of interest, given that:</p> <ul> <li>\u22653 sequencing reads match a specific viral organism.</li> <li>The weighted mean coverage score for a viral organism is \u226510%.</li> <li>The viral organism is not a phage nor a non-human virus.</li> </ul> <p>See documentation of Virus scan for more information.</p> <p>In some cases, however, users may be interested in generating coverage plots of other viral organisms, even if such organisms don't meet the mentioned criteria.</p> <p>For that, they can use the subcommand <code>virmet covplot</code>.  Information on how to use it can be obtained with <code>-h</code>:</p> <pre><code>virmet covplot -h\nusage: virmet covplot [options]\n\nOptions:\n  -h, --help           show this help message and exit\n  --outdir [OUTDIR]    path to store the coverage plots\n  --organism ORGANISM  ssciname of the organism of interest\n  --dbdir [DBDIR]      path to find and use the Virmet database\n</code></pre> <p>Importantly, users must specify the <code>virmet_output_RUN_NAME/SAMPLE_NAME</code> with  <code>--outdir</code>. Otherwise, VirMet doesn't know where to look for the analysed mNGS outputs. The resulting coverage plots will be saved in the same folder.</p> <p>Covplot also requires users to specify the <code>ssciname</code> of the organism of interest, which can be found in the <code>orgs_list.tsv</code> file.</p> <p>To create coverage plots, VirMet will assume that the viral database is stored into <code>/data/virmet_databases</code> and follows the usual VirMet structure. If another path should be considered, users must specify it with <code>--dbdir</code>.</p>"},{"location":"Covplot/#example","title":"Example","text":"<p>As an example, let's suppose users want to investigate sample <code>ABC-DNA_S9</code> in the directory <code>virmet_output_Exp01</code>. First, they go to the directory <code>virmet_output_Exp01/ABC-DNA_S9</code> and check which coverage plots have already been created automatically by VirMet Wolfpack.</p> <p>They see the following:</p> <pre><code>virmet_output_Exp01/\n\u251c\u2500\u2500 ABC-DNA_S9\n\u2502   \u251c\u2500\u2500 Virus_X/\n\u2502   \u2502    \u2514\u2500\u2500 Virus_X_coverage.pdf\n\u2502   \u251c\u2500\u2500 unique.tsv.gz, viral_reads.fastq.gz, undetermined_reads.fastq.gz\n\u2502   \u251c\u2500\u2500 orgs_list.tsv, stats.tsv, fastp.html\n\u2502   \u2514\u2500\u2500 Others.err\n\u251c\u2500\u2500 run_reads_summary.tsv\n\u2514\u2500\u2500 orgs_species_found.tsv\n</code></pre> <p>After that, users may inspect the <code>orgs_list.tsv</code> file and look for any other interesting viruses that didn't meet the above criteria but may still be worth considering.</p> <pre><code>species             accn        reads  stitle              ssciname               covered_region  seq_len\nTunavirus T1        MK213796.1  455    Phage T1            Escherichia phage T1   30152           48836\nVirus X             XX123412.1  79     Virus X, isolate R  Virus X                321             137741\nCoronavirus BCoV    XX000111.1  40     Coronavirus ABC     Bovine coronavirus     141             9372\n</code></pre> <p>Users know that Virus X seems to be a good candidate and inspect the created coverage plot (<code>Virus_X_coverage.pdf</code>). However, they think that Bovine Coronavirus may also be interesting.</p> <p>Therefore, they run:</p> <p><code>virmet covplot --outdir virmet_output_Exp01/ABC-DNA_S9 --organism \"Bovine coronavirus\"</code>.</p> <p>The subcommand <code>covplot</code> will perform the following steps:</p> <ol> <li>Identify all mappings read-organism where the organism name starts with \"Bovine coronavirus\",</li> <li>Identify the genome (or strain of this organism) with the highest number of reads mapped,</li> <li>Align all viral reads to it,</li> <li>Compute the coverage, write it to <code>depth.txt</code> and plot it.</li> </ol> <p>The final result is a pdf file with the name <code>Bovine_coronavirus_coverage.pdf</code>, saved into:</p> <p><code>virmet_output_Exp01/ABC-DNA_S9/Bovine_coronavirus</code>.</p> <p>This allows users to see how reads spread across the genome of this virus and to determine whether it could be a true positive or whether it is just an artifact or contamination.</p> <p>An example of a coverage plot generated by VirMet would be the following:</p> <p></p>"},{"location":"Installation/","title":"Installation Guide","text":"<p>VirMet is available through Bioconda, a channel for the conda package manager. Once conda is installed and the channels are set up, <code>conda install virmet</code> installs the package with all its dependencies.</p>"},{"location":"Installation/#dependencies","title":"Dependencies","text":"<p>The classic <code>python setup.py install</code> should work, provided the user has the necessary permission. VirMet relies on a number of third-party tools used to access databases, trim, convert, filter and map reads: these are automatically installed if VirMet is installed with <code>conda install</code>. If, for some reason, the user prefers to manually install everything, the tools VirMet depends on are:</p> <ul> <li>biopython (Python package)</li> <li>blast &gt;= 2.3</li> <li>bwa</li> <li>entrez-direct (E-utilities from the command line)</li> <li>htslib</li> <li>pandas (Python package)</li> <li>prinseq</li> <li>python (3.x)</li> <li>R with ggplot2 library</li> <li>samtools &gt;= 1.3</li> <li>seqtk</li> </ul>"},{"location":"Installation/#commands","title":"Commands","text":"<p>On a Ubuntu 14.04 the following commands should provide a system wide installation of the tools mentioned above (sudo required).</p> <pre><code># system wide configuration available as Ubuntu packages\nsudo apt-get update -qq\nsudo apt-get install -qq -y build-essential ftp golang unzip \\\nbwa tabix seqtk libwww-perl r-cran-ggplot2\n\n#  NCBI edirect tools\ncd /tmp\nperl -MNet::FTP -e \\\n  '$ftp = new Net::FTP(\"ftp.ncbi.nlm.nih.gov\", Passive =&gt; 1); $ftp-&gt;login;\n   $ftp-&gt;binary; $ftp-&gt;get(\"/entrez/entrezdirect/edirect.zip\");'\nunzip -u -q edirect.zip\nrm edirect.zip\nexport PATH=$PATH:/tmp/edirect\n./edirect/setup.sh\ncd edirect\nsudo install -p econtact edirutil efilter elink entrez-phrase-search eproxy \\\nespell ftp-cp join-into-groups-of sort-uniq-count-rank xtract xtract.Linux \\\neaddress edirect.pl efetch einfo enotify epost esearch esummary ftp-ls nquire \\\nreorder-columns setup-deps.pl sort-uniq-count word-at-a-time xtract.pl /usr/local/bin\n\n# prinseq\ncd /tmp\nwget http://downloads.sourceforge.net/project/prinseq/standalone/prinseq-lite-0.20.4.tar.gz \\\n-O /tmp/prinseq-lite-0.20.4.tar.gz\ntar -xvf /tmp/prinseq-lite-0.20.4.tar.gz\nsudo install -p tmp/prinseq-lite-0.20.4/prinseq-lite.pl /usr/local/bin\n\n# samtools 1.3\nwget https://github.com/samtools/samtools/releases/download/1.3/samtools-1.3.tar.bz2 \\\n-O /tmp/samtools-1.3.tar.bz2\ntar xvfj /tmp/samtools-1.3.tar.bz2\ncd /tmp/samtools-1.3\nmake\nsudo make prefix=/usr/local install\n\n# NCBI blast+ 2.3.0\ncd /tmp\nwget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/LATEST/ncbi-blast-2.3.0+-x64-linux.tar.gz\ntar xzfp ncbi-blast-2.3.0+-x64-linux.tar.gz\nsudo install -p ./ncbi-blast-2.3.0+/bin/* /usr/local/bin\n\n# edirect looks for uname in the wrong place\nsudo ln -sv /bin/uname /usr/bin/uname\n\nexport PATH=/usr/local/bin:$PATH\n</code></pre> <p>Then, one needs python 3 (VirMet was mainly developed and tested on 3.4/3.5), but any 3.x should work), together with pandas and Biopython. Go to the respective installation pages and choose your favourite method.</p>"},{"location":"Preparation/","title":"Preparing for a real run: <code>fetch</code> or <code>update</code>, and <code>index</code>","text":""},{"location":"Preparation/#fetch","title":"Fetch","text":"<p>After installation, one needs to populate the database directory. By default this will be <code>/data/virmet_databases_update</code>, but it can be modified by the users. In order to populate this database, use the subcommand <code>fetch</code> as follows:</p> <pre><code>virmet fetch --viral n\nvirmet fetch --human\nvirmet fetch --bact_fungal\nvirmet fetch --bovine\n</code></pre> <p>This might take long, because databases are big. Therefore, we strongly recommend running it inside a <code>tmux</code> session.</p> <p>By default, the download of the viral database performs a compression step. Users can avoid it with <code>--no_db_compression</code>. However, we highly discourage to do that because subsequent analyses will be much slower and the senstivity improvement during the  viral classification process is minimal.</p> <p>Remarkably, only the option <code>--viral</code> takes an argument: <code>n</code> for nucleotide and <code>p</code> for the protein viral database. However, please note that only nucleotide sequences are used currently by Wolfpack, while the protein sequences  are planned for future expansions of the tool.</p> <p>Further information on the <code>fetch</code> subcommand can be obtained using <code>-h</code>:</p> <pre><code>virmet fetch -h\nusage: virmet &lt;command&gt; [options]\n\noptions:\n  -h, --help           show this help message and exit\n  --viral {n,p}        viral [nucleic acids/proteins]\n  --human              human\n  --bact_fungal        bacterial and fungal(RefSeq)\n  --bovine             bovine (Bos taurus)\n  --no_db_compression  do not compress the viral database\n  --dbdir [DBDIR]      path to store the new Virmet database\n</code></pre>"},{"location":"Preparation/#update","title":"Update","text":"<p>More and more genomes are uploaded to NCBI database every month.</p> <p>VirMet provides a simple way to update the viral database without the need to download all the genomes again. This can be done with the subcommand <code>update</code> as follows:</p> <p><code>virmet update --viral n --update_min_date YYYY/MM/DD</code></p> <p>Information on how to use the <code>update</code> subcomand can be obtained with <code>-h</code>:</p> <pre><code>virmet update -h\nusage: virmet &lt;command&gt; [options] \n\noptions:\n  -h, --help            show this help message and exit\n  --viral {n,p}         update viral [n]ucleic/[p]rotein\n  --picked              PICKED       \n                        file with additional sequences, one ACC per line\n  --update_min_date     UPDATE_MIN_DATE\n                        update viral database with sequences produced after date YYYY/MM/DD\n  --no_db_compression   do not compress the viral database\n  --dbdir [DBDIR]       path to store the updated Virmet database\n</code></pre> <p>In addition to choosing a specific date from which to look for reference sequences (<code>--update_min_date</code>), users can also provide a .txt file with specific viral genomes to include in the database (<code>--picked</code>). For that, they need to provide all the Accession Numbers (ACC) of these genomes as they appear in the NCBI RefSeq database. The .txt file should contain one Accession Number per row.</p> <p>As mentioned for the <code>fetch</code> subcommand, <code>update</code> also allows users to skip the compression step (<code>--no_db_compression</code>) of the viral database, although this is highly discouraged. Users can also change the default database path (<code>--dbdir</code>) if  their whole VirMet database is in another location.</p> <p>Important: don't forget to index the viral database again once it has been updated.</p>"},{"location":"Preparation/#index","title":"Index","text":"<p>After dowloading or updating the databases, it's always needed to index them. The subcommand <code>virmet index</code> is used for that, and it can take multiple arguments. Therefore, if users need to index the whole VirMet database, they can run: </p> <p><code>virmet index --viral n --human --bact_fungal --bovine</code></p> <p>and wait for the indexing to finish.</p> <p>Alternatively, if they need to index only the viral database, they can do it as follows: <code>virmet index --viral n</code></p> <p>Further information on how to use the <code>index</code> subcommand can be obtained with <code>-h</code>:</p> <pre><code>virmet index -h\nusage: virmet &lt;command&gt; [options]\n\noptions:\n  -h, --help       show this help message and exit\n  --viral {n,p}    make blast index of viral database\n  --human          make bwa index of human database\n  --bact_fungal    build kraken2 bacterial and fungal database\n  --bovine         make bwa index of bovine database\n  --dbdir [DBDIR]  path to store the indexed Virmet database\n</code></pre>"},{"location":"Preparation/#database-structure","title":"Database structure","text":"<p>If everything works as expected, your database directory should have the following structure:</p> <p><pre><code>virmet_databases_update/\n\u251c\u2500\u2500 viral_nuccore/\n\u2502   \u251c\u2500\u2500 viral_database.fasta\n\u2502   \u251c\u2500\u2500 viral_accn_taxid.dmp\n\u2502   \u2514\u2500\u2500 viral_seqs_info.tsv\n\u251c\u2500\u2500 human/\n\u2502   \u251c\u2500\u2500 fasta/\n\u2502   \u2502   \u2514\u2500\u2500 GRCh38.fasta.gz\n\u2502   \u2514\u2500\u2500 bwa/\n\u2502       \u2514\u2500\u2500 bwa_files\n\u251c\u2500\u2500 bovine/\n\u2502   \u251c\u2500\u2500 fasta/\n\u2502   \u2502   \u2514\u2500\u2500 ref_Bos_taurus.fasta.gz\n\u2502   \u2514\u2500\u2500 bwa/\n\u2502       \u2514\u2500\u2500 bwa_files\n\u251c\u2500\u2500 bact_fungi/\n\u2502   \u251c\u2500\u2500 library/\n\u2502   \u2502   \u251c\u2500\u2500 bacteria\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 library.fna\n\u2502   \u2502   \u2514\u2500\u2500 fungi\n\u2502   \u2502       \u2514\u2500\u2500 library.fna\n\u2502   \u2514\u2500\u2500 taxonomy/\n\u2502       \u2514\u2500\u2500 taxdump.tar.gz\n\u251c\u2500\u2500 names.dmp.gz\n\u2514\u2500\u2500 nodes.dmp.gz\n</code></pre> Please, note that the name of the database doesn't need to be necessarily <code>virmet_databases_update</code>. This is the default name.</p> <p>If you read until here, you are ready to use VirMet Wolfpack!</p> <p>Enjoy analysing your mNGS samples!</p>"},{"location":"Wolfpack/","title":"Running a virus scan: <code>wolfpack</code>","text":""},{"location":"Wolfpack/#wolfpack","title":"Wolfpack","text":"<p>Wolfpack is the main subcommand of VirMet and it allows to perform mNGS analyses of the given samples (virus scan).</p> <p>Information on how to use it can be obtained with <code>-h</code>:</p> <pre><code>virmet wolfpack -h\nusage: virmet wolfpack [options]\n\nOptions:\n  -h, --help       show this help message and exit\n  --run RUN        Miseq run directory\n  --file FILE      single fastq file\n  --dbdir [DBDIR]  path to find and use the Virmet database. Default: /data/virmet_databases/\n  --nocovplot      do not make the covplots. Default: make them\n  --noctrls        do not analyse ntc- or Undetermined samples. Default: analyse them\n</code></pre> <p>Wolfpack can be run on a single file (<code>--file</code>) or on a directory (<code>--run</code>). If a directory is provided, it analyses all the FASTQ files in there. Please, note that Wolfpack works if the structure of the <code>--run</code> directory is any of these 2:</p> <pre><code># Structure 1\nrun_directory/\n\u251c\u2500\u2500 FASTQ_file_1\n\u251c\u2500\u2500 FASTQ_file_2\n\u251c\u2500\u2500 ...\n\u2514\u2500\u2500 FASTQ_file_n\n\n# Structure 2\nrun_directory/\n\u2514\u2500\u2500 Data/\n    \u2514\u2500\u2500 Intensities/\n        \u2514\u2500\u2500 BaseCalls/\n            \u251c\u2500\u2500 FASTQ_file_1\n            \u251c\u2500\u2500 FASTQ_file_2\n            \u251c\u2500\u2500 ...\n            \u2514\u2500\u2500 FASTQ_file_n\n</code></pre> <p>Importantly, the extension of the FASTQ files must be <code>.fastq</code> or <code>.fastq.gz</code>.</p> <p>To run Wolfpack, users have the option to specify <code>--dbdir</code>, which is the path to the VirMet database and must include the viral, human, bovine,  bacterial and fungal (bact_fungi) databases. See how to prepare for a VirMet run before running Wolfpack. If <code>-dbdir</code> is not specified, VirMet will assume that it is located in <code>/data/virmet_databases/</code>.</p> <p>Users also have the option to run the mNGS analyses on all the FASTQ files (the default behaviour), which usually include negative controls and  undertermined reads, or to skip those with <code>--noctrls</code>. In this case, all files named <code>ntc-*</code> or <code>Undetermined*</code> will be ignored.</p> <p>To carry out the virus scan, Wolfpack will first run a filtering step (QC) based on quality, length and entropy of the given reads (named quality-control). Then, it will perform a decontamination step, where reads of human, bovine, bacterial and fungal origin will be discarded. Finally, remaining reads will be blasted against the viral database and the viruses present in the mNGS samples will be identified.</p> <p>Before providing the results, Wolfpack will (by default) automatically check which of the identified viral organisms fulfill these criteria:</p> <ul> <li>\u22653 sequencing reads match this specific viral organism.</li> <li>The weighted mean coverage score for this viral organism is \u226510%.</li> <li>The viral organism is not a phage nor a non-human virus (host is human).</li> </ul> <p>For all the viral organisms meeting these criteria, Wolfpack will generate Coverage plots, where users can see what fraction of the genome is covered by the sequenncing reads. This will provide them with further evidence supporting (or not) the presence of the organism in the sample.</p> <p>If users want to avoid this last step and are not interested in getting the coverage plots, they can disable such option with <code>--nocovplot</code>.</p>"},{"location":"Wolfpack/#outputs","title":"Outputs","text":"<p>Virmet Wolfpack provides several outputs that can be found in the output folder <code>virmet_output_RUN_NAME</code>, located at the current working directory.</p> <p>For example, if users have a directory named <code>Exp01</code> with files:</p> <pre><code>exp_01/ABC-DNA_S9.fastq.gz\nexp_01/DEF-RNA_S11.fastq.gz\n</code></pre> <p>and run <code>virmet wolfpack --run Exp01</code>, their results will appear into <code>virmet_output_Exp01</code>.</p> <p>The most important output files are:</p> <ul> <li>Orgs_species_found.csv: table showing the viral organisms identified per FASTQ file as well as the read counts matching each organism. It looks as follows:</li> </ul> <pre><code>species                accn        reads  stitle               ssciname               covered_region  seq_len  sample       run\nTunavirus T1           MK213796.1  455    Phage T1             Escherichia phage T1   30152           48836    ABC-DNA_S9   Exp01\nVaricellovirus a5      KY559403.2  79     Alphaherpesvirus 5   Alphaherpesvirus 5     321             137741   ABC-DNA_S9   Exp01\nLentivirus humimdef1   MT222957.1  13     HIV-1 isolate X      HIV-1                  141             9372     DEF-RNA_S11  Exp01\nEmesvirus zinderi      EF204940.1  6265   Phage MS2 isolate Y  Escherichia phage MS2  2836            3569     DEF-RNA_S11  Exp01\n</code></pre> <ul> <li>Run_reads_summary.tsv: summary of all reads analyzed per sample, showing the number of reads passing each step of the pipeline (e.g., QC, decontamination), and the number of reads matching the human, bovine, bacterial, fungal and viral database. It looks as follows:</li> </ul> <pre><code>category              reads     sample       run\nraw_reads             2656448   ABC-DNA_S9   Exp01\ntrimmed_too_short     46        ABC-DNA_S9   Exp01\nlow_entropy           25        ABC-DNA_S9   Exp01\nlow_quality           1081      ABC-DNA_S9   Exp01\npassing_filter        2655296   ABC-DNA_S9   Exp01\nmatching_humanGRCh38  339020    ABC-DNA_S9   Exp01\nmatching_bt_ref       1319509   ABC-DNA_S9   Exp01\nmatching_bacteria     46024     ABC-DNA_S9   Exp01\nmatching_fungi        10        ABC-DNA_S9   Exp01\nmatching_other_cells  7403      ABC-DNA_S9   Exp01\nreads_to_blast        943330    ABC-DNA_S9   Exp01\nviral_reads           70579     ABC-DNA_S9   Exp01\nundetermined_reads    872751    ABC-DNA_S9   Exp01\nraw_reads             2202164   DEF-RNA_S11  Exp01\ntrimmed_too_short     259441    DEF-RNA_S11  Exp01\nlow_entropy           18        DEF-RNA_S11  Exp01\nlow_quality           1277      DEF-RNA_S11  Exp01\npassing_filter        1941428   DEF-RNA_S11  Exp01\nmatching_humanGRCh38  526874    DEF-RNA_S11  Exp01\nmatching_bt_ref       819466    DEF-RNA_S11  Exp01\nmatching_bacteria     8721      DEF-RNA_S11  Exp01\nmatching_fungi        21        DEF-RNA_S11  Exp01\nmatching_other_cells  299       DEF-RNA_S11  Exp01\nreads_to_blast        586047    DEF-RNA_S11  Exp01\nviral_reads           168247    DEF-RNA_S11  Exp01\nundetermined_reads    417800    DEF-RNA_S11  Exp01\n</code></pre> <p>In addition to these main outputs, Wolfpack creates inside <code>virmet_output_RUN_NAME</code> a subdirectory for each sample (FASTQ file). There, users can find these additional files: </p> <ul> <li>Unique.tsv.gz</li> <li>Viral_reads.fastq.gz</li> <li>Undetermined_reads.fastq.gz</li> <li>Orgs_list.tsv</li> <li>Stats.tsv</li> <li>Fastp.html</li> <li>Folders named as viral organisms</li> <li>Other.err</li> </ul> <p>Files <code>orgs_list.tsv</code> and <code>stats.tsv</code> report the main output of the tool for each sample. They are the same as <code>Orgs_species_found.csv</code> and <code>Run_reads_summary.tsv</code>, respectively, but containing information only of one sample. Therefore, the last two columns (sample and run) are missing.</p> <p>The <code>unique.tsv.gz</code> reports all BLAST hits to the viral database. These are not the same as in <code>orgs_list.tsv</code> because VirMet further filters the BLAST hits (<code>unique.tsv.gz</code>) to ensure that only those with \u226575% pident and \u226575% qcov are ultimately considered viral reads for diagnosis. </p> <p>As the names say, <code>viral_reads.fastq.gz</code> and <code>undetermined_reads.fastq.gz</code> contain, respectively, reads identified as of viral origin and reads not matching any of the considered genomes.</p> <p>Finally, <code>fastp.html</code> shows the quality-control statistics and information about the QC-filtering step.</p> <p>In the decontamination step, reads are aligned against the human genome first, those matching are discarded while those not matching are aligned against the bovine genome, and so on. In each step, some files ending with .err are generated, and they can be used for inspection, if needed. However, they do not provide valuable information for the users (unless there is any error) and can be removed if desired.</p> <p>Besides all these files, Wolfpack automatically creates (unless disabled with <code>--nocovplot</code>) a few folders with the names of viral organisms. Such folders contain the coverage plots of the viral assignments, named <code>Viral_organism_coverage.pdf</code>. It is recommended to manually have a look at them before a final viral diagnosis.</p> <p>Overall, users can expect the following structure for the outputs:</p> <pre><code>virmet_output_Exp01/\n\u2502\n\u251c\u2500\u2500 ABC-DNA_S9\n\u2502   \u251c\u2500\u2500 Virus_X/\n\u2502   \u2502    \u2514\u2500\u2500 Virus_X_coverage.pdf\n\u2502   \u251c\u2500\u2500 unique.tsv.gz, viral_reads.fastq.gz, undetermined_reads.fastq.gz\n\u2502   \u251c\u2500\u2500 orgs_list.tsv, stats.tsv, fastp.html\n\u2502   \u2514\u2500\u2500 Others.err\n\u2502 \n\u251c\u2500\u2500 DEF-RNA_S11\n\u2502   \u251c\u2500\u2500 Virus_Y/\n\u2502   \u2502   \u2514\u2500\u2500 Virus_Y_coverage.pdf\n\u2502   \u251c\u2500\u2500 Virus_Z/\n\u2502   \u2502   \u2514\u2500\u2500 Virus_Z_coverage.pdf\n\u2502   \u251c\u2500\u2500 unique.tsv.gz, viral_reads.fastq.gz, undetermined_reads.fastq.gz\n\u2502   \u251c\u2500\u2500 orgs_list.tsv, stats.tsv, fastp.html\n\u2502   \u2514\u2500\u2500 Others.err\n\u2502\n\u251c\u2500\u2500 run_reads_summary.tsv\n\u2514\u2500\u2500 orgs_species_found.tsv\n</code></pre> <p>More information about the Coverage plots is provided in the corresponding section.</p>"},{"location":"Wolfpack/#hot-run","title":"Hot run","text":"<p>A virus scan on a full MiSeq run typically lasts a few hours, most of which are spent in the decontamination phase. Sometimes, after a run is completed, we would like to run it again with a new viral database. In these cases, <code>wolfpack</code> would run skipping the previous phases to save time. It relies on the presence of intermediate files that, if present, signals the pipeline that a specific step must be skipped.</p> <p>These are the rules (must be intended for each sample):</p> <ul> <li>If <code>fastp.html</code> exists, skip quality filtering.</li> <li>If <code>good_humanGRCh38.err</code> exists, skip the human reads decontamination.</li> <li>If <code>good_humanGRCh38_bt_ref.err</code> exists, skip the bovine reads decontamination.</li> <li>if <code>good_humanGRCh38_bt_ref_bact_fungi.err.err</code> exists, skip the  decontamination bacterial and fungal database.</li> </ul> <p>Blasting against viral database will always be performed. If both <code>viral_reads.fastq.gz</code> and <code>undetermined_reads.fastq.gz</code> exist, their content will be copied into a file, they will be removed, and this new file will be blasted against the viral database.</p> <p>Therefore, if users change the viral database after a run has already been analyzed, running <code>virmet wolfpack</code> again will skip the quality filtering and decontamination steps and proceed directly with the viral assignment.</p> <p>Enjoy with your viral classification!</p>"}]}